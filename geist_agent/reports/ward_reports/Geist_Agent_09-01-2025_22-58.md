# Ward: Security Audit

_Root_: `Geist-Agent`  
_Scan method_: **OSV API**  
Findings: **52 vulns** (C:3 H:13 M:16 L:3 U:17), **0 secrets**, **0 risky patterns**

## Summary
### Overview
- By severity: CRITICAL:3, HIGH:13, MEDIUM:16, LOW:3, UNKNOWN:17
- By ecosystem: PyPI:52

### Most-affected packages
- `PyPI:gradio@4.11.0` — 48 advisory(ies)
- `PyPI:streamlit@1.29.0` — 3 advisory(ies)
- `PyPI:fastapi@0.104.0` — 1 advisory(ies)


### Impact Themes
- Path/Dir Traversal: 5
- CORS Misconfig: 4
- Arbitrary File Access: 4
- LFI/RFI: 3
- SSRF: 3
- Insecure Transport: 2
- DoS: 2
- Open Redirect: 2

## Vulnerabilities by Package
- `PyPI:gradio@4.11.0` — **48 advisories** (e.g., GHSA-26jh-r8g2-6fpr, GHSA-279j-x4gx-hfrh, GHSA-34rf-p3r3-58x2, GHSA-37qc-qgx6-9xjv, GHSA-3c67-5hwx-f6wx, GHSA-3f95-mxq2-2f63, GHSA-3gf9-wv65-gwh9, GHSA-48cq-79qq-6f7x …(+40 more IDs))
- `PyPI:streamlit@1.29.0` — **3 advisories** (e.g., GHSA-8qw9-gf7w-42x5, GHSA-rxff-vr5r-8cj5, PYSEC-2024-153)
- `PyPI:fastapi@0.104.0` — **1 advisories** (e.g., PYSEC-2024-38)

## Top Vulnerabilities
- `GHSA-gqvf-3hgp-5hxv` **CRITICAL** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-gqvf-3hgp-5hxv) — Gradio Exposure of Sensitive Information to an Unauthorized Actor vulnerability
- `GHSA-j2jg-fq62-7c3h` **CRITICAL** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-j2jg-fq62-7c3h) — Gradio Blocked Path ACL Bypass Vulnerability
- `GHSA-m842-4qm8-7gpq` **CRITICAL** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-m842-4qm8-7gpq) — Gradio allows users to access arbitrary files
- `GHSA-279j-x4gx-hfrh` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-279j-x4gx-hfrh) — Gradio uses insecure communication between the FRP client and server
- `GHSA-3c67-5hwx-f6wx` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-3c67-5hwx-f6wx) — Gradios's CORS origin validation is not performed when the request has a cookie
- `GHSA-3f95-mxq2-2f63` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-3f95-mxq2-2f63) — Gradio Local File Inclusion vulnerability
- `GHSA-5cpq-9538-jm2j` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-5cpq-9538-jm2j) — Gradio DOS in multipart boundry while uploading the file
- `GHSA-6v6g-j5fq-hpvw` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-6v6g-j5fq-hpvw) — Local file inclusion in gradio
- `GHSA-7xmc-vhjp-qv5q` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-7xmc-vhjp-qv5q) — Gradio Vulnerable to Denial of Service (DoS) via Crafted Zip Bomb
- `GHSA-8c87-gvhj-xm8m` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-8c87-gvhj-xm8m) — Gradio lacks integrity checking on the downloaded FRP client
- `GHSA-973g-55hp-3frw` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-973g-55hp-3frw) — Server-Side Request Forgery in gradio
- `GHSA-g9cj-cfpp-4g2x` **HIGH** — PyPI:gradio@4.11.0 — [details](https://github.com/advisories/GHSA-g9cj-cfpp-4g2x) — gradio vulnerable to Path Traversal

## LLM Summary & Recommendations

```markdown
### Summary of Vulnerability Landscape
The ecosystem consists of 52 vulnerabilities across PyPI packages, with `gradio` being the most affected. The landscape is dominated by high severity issues such as arbitrary file inclusion, server-side request forgery, and denial-of-service vulnerabilities.

### Remediation Recommendations
1. **Update Dependencies**: Ensure all packages are up-to-date to mitigate known vulnerabilities.
2. **Secure Communication**: Implement secure protocols for communication between the FRP client and server.
3. **Input Validation**: Add robust input validation and sanitization to prevent path traversal and local file inclusion attacks.
4. **CORS Policy Enforcement**: Enforce strict CORS policies to limit unauthorized access from third-party origins.
5. **Audit Logs**: Enable detailed logging and monitoring to detect and respond to suspicious activities promptly.
```

## Monitoring & Continuous Scans
- **Baseline diff in CI:** Keep `security/osv-baseline.json`. Fail PRs only on **NEW** `HIGH`/`CRITICAL` advisories vs baseline.
- **Create/refresh baseline:** run `poltergeist ward -p <root> --json` and copy the JSON to `security/osv-baseline.json` after triage.
- **How to diff IDs (example):** extract IDs and compare to fail on new ones.
```sh
# assumes: previous baseline at security/osv-baseline.json
# and current scan saved as ward_current.json
jq -r '.vulns[].id' security/osv-baseline.json | sort > base.txt
jq -r '.vulns[].id' ward_current.json           | sort > curr.txt
NEW=$(comm -13 base.txt curr.txt)
test -z "$NEW" || { echo "New advisories:"; echo "$NEW"; exit 1; }
```
- **Scheduled sweep:** run a weekly full scan on the default branch and auto-open an issue for any net-new `MEDIUM+`.
- **Release gate:** block releases unless `HIGH+` are 0 or time-boxed with owner + expiry in an allowlist.
